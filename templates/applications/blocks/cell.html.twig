{% if cell.field %}

    {% if cell.field.type == 'image' and cell.value %}
        {% if cell.link %}
            {% include 'applications/blocks/cell_link.html.twig' with {image: cell.value, link: route(cell.link), title: cell.title} %}
        {% else %}
            <span class="media-box">
                {% include 'applications/blocks/image_small.html.twig' with {source: cell.value, title: cell.title} %}
                {% if cell.title %}
                    <span class="media-title">{{ cell.title }}</span>
                {% endif %}
            </span>
        {% endif %}

    {% elseif cell.field.type == 'file' and cell.value %}
        <a href="{{ absolute_url(cell.value) }}" title="Download {{ cell.field.labels.default }}" target="_blank">
            <i class="fa-solid fa-file"></i> {#fixme filetype#}
        </a>

    {% elseif cell.field.type in ['date', 'datetime'] %}
        {# fixme: twig pretty date filter #}
        {% if cell.transformed %}
            {{ cell.value }}
        {% elseif cell.value is not null %}
            <span title="{{ ('time.dow.'~cell.value.format('l')|lower)|trans }}">
                {{ ('value.date.year-mo-MO-day')|trans({
                    year: cell.value.format('Y'),
                    mo: cell.value.format('m'),
                    MO: ('time.month.'~cell.value.format('M'))|lower|trans,
                    day: cell.value.format('d'),
                    DAY: ('time.dow.'~cell.value.format('D'))|lower|trans})
                }}
            </span>

        {% endif %}

    {% elseif cell.field.type == 'time' %}
        {# fixme: twig pretty date filter #}
        {% if cell.transformed %}
            {{ cell.value }}
        {% elseif cell.value is not null %}
            {{ cell.value.format('H:i') }}
        {% endif %}

    {% elseif cell.field.type == 'boolean' %}
        <span class="text-center"><i class="fa-solid fa-{{ cell.value ? 'check' : 'xmark' }}"></i></span>
        <span class="d-none">{{ cell.value }}</span> {# hidden value for sorting #}

    {% elseif cell.field.type == 'rating' %}
        {# todo: half stars #}
        {% for i in 1..cell.value %}
            <i class="fa-solid fa-star"></i>
        {% endfor %}

    {% elseif cell.field.type == 'textbox' %}
        {{ cell.value|nl2br }}
    {% else %}
        {% if cell.link or cell.field.type == 'url' %}
            {% if cell.value is iterable and cell.link is iterable %}
                {% for k,link in cell.link %}
                    {% include 'applications/blocks/cell_link.html.twig' with {text: cell.value[k], link: link} %}
                {% endfor %}
            {% elseif cell.field.type == 'url' and cell.value %}
                {% include 'applications/blocks/cell_link.html.twig' with {text: cell.value, link: cell.value, target: "blank"} %}
            {% elseif cell.field.type != 'url' %}
                {% include 'applications/blocks/cell_link.html.twig' with {text: cell.value, link: cell.link} %}
            {% endif %}
        {% elseif cell.reference %}
            {% include 'applications/blocks/cell_link.html.twig' with {text: cell.value, link: cell.reference, icon: 'fa-solid fa-magnifying-glass'} %}
        {% else %}
            {#  todo: choice translations -> dash builder #}
            {% if cell.value is iterable %}
                {{ cell.value|join(', ') }}
            {% else %}
                {{ cell.value }}
            {% endif %}
        {% endif %}
    {% endif %}

{% elseif cell.link %}
    {% for p in cell %}
        {# todo: pointers #}
    {% endfor %}
{% endif %}
